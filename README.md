# OCA Data Set Validator
This is a Python script for validating [Overlays Capture Architecture (OCA)](https://oca.colossi.network/) data sets. It includes three classes: `OCADataSet`, `OCADataSetErr`, and `OCABundle`.

- OCADataSet represents an OCA data set to be validated, and can be loaded from a pandas DataFrame, an OCA Excel Data Entry File, or a CSV file.

- OCADataSetErr represents the result set of an OCA data set validation. This class is generated by the data set validation, contains all the error information, and also provides three methods for a quick overview: `overview()`, `first_error_col()`, and `get_error_col(attr_name)`.

- OCABundle represents a loaded OCA bundle from OCA zip files, which are used to validate the data set.

## Dependencies
- pandas
- pathlib

## Usage

### Installation
Download and copy the oca_ds_validator.py to your working folder. Then you could import the classes from any Python scripts in the same directory.

### Validation
```python
from oca_ds_validator import OCADataSet, OCADataSetErr, OCABundle

test_bundle = OCABundle("/path/to/oca/bundle.zip")

test_data = OCADataSet(data_set_dataframe)
# test_data = OCADataSet.from_path("/path/to/oca/data_entry_file.xlsx")
# test_data = OCADataSet.from_path("/path/to/oca/data_set_file.csv")

test_rslt = test_bundle.validate(test_data)
#########################################################################################
# Example of a possible test_rslt:
#   attr_err:    # Missing or misnamed attributes
#     []
#   format_err:  # Attribute type or attribute format errors
#     {'bool_arr_attr': {1: 'Valid array required.'}, 
#      'bool_attr': {2: 'Format mismatch.'}, 
#      'num_arr_attr': {1: 'Format mismatch.', 2: 'Valid array required.'}, 
#      'text_arr_entry_attr': {}, 
#      'text_entry_attr': {}}
#   encode_err:  # Not matching any of the entry codes
#     {'text_arr_entry_attr': {0: 'One of the entry codes required.'},
#      'text_entry_attr': {2: 'One of the entry codes required.'}}
#########################################################################################
```

### Result Observation
```Python
test_rslt.overview()  # Prints a brief summary of errors.
#########################################################################################
# Found 8 problematic row(s) in the following column(s): 
# {'bool_attr', 
#  'text_arr_entry_attr', 
#  'bool_arr_attr', 
#  'text_entry_attr', 
#  'num_arr_attr'}
#########################################################################################

test_rslt.first_err_col()  # Prints the information of the first problematic column.
#########################################################################################
# The first problematic column is: bool_arr_attr
# Format error(s) would occur in the following rows:
# row 1 : Valid array required.
# No entry code error found in the column.
#########################################################################################

test_rslt.get_err_col("bool_attr")  # Prints the information of some certain column.
#########################################################################################
# Format error(s) would occur in the following rows of column bool_attr:
# row 2 : Format mismatch.
# No entry code error found in the column.
#########################################################################################
```

### Further Processing
```Python
# Get dictionaries of error details.
test_rslt.get_format_err()
test_rslt.get_ecode_err()
```
